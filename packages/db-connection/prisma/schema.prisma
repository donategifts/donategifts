generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL_URL")
}

model Address {
  id        Int       @id @default(autoincrement())
  address1  String
  address2  String?
  city      String
  country   String
  state     String
  createdAt DateTime  @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt DateTime  @default(dbgenerated())
  deletedAt DateTime?
  Agency    Agency?
  Child     Child[]
}

model Agency {
  id            Int             @id @default(autoincrement())
  name          String
  bio           String?
  isVerified    Boolean         @default(false)
  phone         String
  website       String?
  addressId     Int             @unique
  createdAt     DateTime        @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt     DateTime        @default(dbgenerated())
  deletedAt     DateTime?
  Address       Address         @relation(fields: [addressId], references: [id])
  AgencyMembers AgencyMembers[]
  Wishcard      Wishcard[]
}

model AgencyMembers {
  agencyId Int
  userId   Int
  role     AgencyMembers_role
  Agency   Agency             @relation(fields: [agencyId], references: [id])
  User     User               @relation(fields: [userId], references: [id])

  @@id([agencyId, userId])
  @@index([userId], name: "userId")
}

model Child {
  id        Int        @id @default(autoincrement())
  birthday  DateTime
  firstName String
  lastName  String?
  interest  String
  bio       String?
  addressId Int
  createdAt DateTime   @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt DateTime   @default(dbgenerated())
  deletedAt DateTime?
  Address   Address    @relation(fields: [addressId], references: [id])
  Wishcard  Wishcard[]

  @@index([addressId], name: "addressId")
}

model Donation {
  id         Int             @id @default(autoincrement())
  wishcardId Int
  userId     Int
  amount     Float
  status     Donation_status
  createdAt  DateTime        @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt  DateTime        @default(dbgenerated())
  deletedAt  DateTime?
  User       User            @relation(fields: [userId], references: [id])
  Wishcard   Wishcard        @relation(fields: [wishcardId], references: [id])

  @@index([userId], name: "userId")
  @@index([wishcardId], name: "wishcardId")
}

model Message {
  id         Int       @id @default(autoincrement())
  userId     Int
  wishcardId Int
  message    String
  createdAt  DateTime  @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt  DateTime  @default(dbgenerated())
  deletedAt  DateTime?
  User       User      @relation(fields: [userId], references: [id])
  Wishcard   Wishcard  @relation(fields: [wishcardId], references: [id])

  @@index([userId], name: "userId")
  @@index([wishcardId], name: "wishcardId")
}

model User {
  id                                 Int             @id @default(autoincrement())
  firstName                          String
  lastName                           String
  profileImage                       String?
  email                              String          @unique
  emailVerified                      Boolean         @default(false)
  emailVerificationHash              String?         @unique
  role                               User_role
  loginMode                          User_loginMode
  password                           String
  passwordResetToken                 String?         @unique
  passwordResetTokenExpires          DateTime?
  createdAt                          DateTime        @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt                          DateTime        @default(dbgenerated())
  deletedAt                          DateTime?
  AgencyMembers                      AgencyMembers[]
  Donation                           Donation[]
  Message                            Message[]
  Wishcard_UserToWishcard_createdBy  Wishcard[]      @relation("UserToWishcard_createdBy")
  Wishcard_UserToWishcard_isLockedBy Wishcard[]      @relation("UserToWishcard_isLockedBy")
}

model Wishcard {
  id                             Int             @id @default(autoincrement())
  image                          String
  itemPrice                      Float
  itemUrl                        String
  childId                        Int
  agencyId                       Int
  createdBy                      Int
  isLockedBy                     Int?
  isLockedUntil                  DateTime?
  status                         Wishcard_status
  occasion                       String?
  createdAt                      DateTime        @default(now())
  /// The value of this field is generated by the database as: `'0000-00-00 00:00:00'`.
  updatedAt                      DateTime        @default(dbgenerated())
  deletedAt                      DateTime?
  Agency                         Agency          @relation(fields: [agencyId], references: [id])
  Child                          Child           @relation(fields: [childId], references: [id])
  User_UserToWishcard_createdBy  User            @relation("UserToWishcard_createdBy", fields: [createdBy], references: [id])
  User_UserToWishcard_isLockedBy User?           @relation("UserToWishcard_isLockedBy", fields: [isLockedBy], references: [id])
  Donation                       Donation[]
  Message                        Message[]

  @@index([agencyId], name: "agencyId")
  @@index([childId], name: "childId")
  @@index([createdBy], name: "createdBy")
  @@index([isLockedBy], name: "isLockedBy")
}

enum AgencyMembers_role {
  admin
  member
}

enum Donation_status {
  confirmed
  ordered
  delivered
}

enum User_role {
  donor
  partner
  admin
}

enum Wishcard_status {
  draft
  published
  donated
}

enum User_loginMode {
  Facebook
  Google
  Default
}
